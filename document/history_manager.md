# HistoryManager

## Назначение
Отвечает за хранение и восстановление истории вычислений/команд. Сохраняет список строк в текстовом файле и предоставляет API для пополнения и чтения истории.

## Структура данных
- `history_file_path_` — абсолютный путь к файлу истории. Относительные пути преобразуются в системный каталог конфигурации (тот же, что использует `ConfigManager`) и дополняются именем `history.log`.
- `history_` — вектор строк, содержащий все записи истории в порядке добавления.

## Поток работы
1. `load()` очищает текущее состояние, проверяет наличие файла истории и при необходимости создаёт родительскую директорию.
2. Содержимое файла считывается построчно; каждая непустая строка добавляется в `history_` (учитывается удаление `\r` для совместимости с CRLF).
3. `save()` сериализует `history_` обратно в файл, разделяя записи символом перевода строки.

## Публичные методы
- `void add_entry(const string& entry)` — добавляет новую запись, игнорируя пустые строки.
- `const vector<string>& get_history() const` — возвращает текущее состояние истории для чтения.
- Наследованные `load()` / `save()` используются вызывающим кодом для синхронизации с диском.

## Особенности
- Работает поверх `FileManager`, что обеспечивает безопасную работу с файловой системой (создание директорий, запись данных).
- Разрешает путь к истории так, чтобы файл лежал рядом с конфигурацией приложения:
  - Windows: `%APPDATA%` или `%LOCALAPPDATA%`.
  - macOS: `~/Library/Application Support`.
  - Linux и Unix: `~/.config` или `$XDG_CONFIG_HOME`.
- Если передать относительный путь без расширения, будет использован шаблон `<config_root>/<путь>/history.log`. При передаче имени файла расширение `.log` добавляется автоматически.
- Не контролирует максимальный размер истории — ответственность за лимиты лежит на вызывающем коде.

## Как использовать
1. Создайте экземпляр. По умолчанию `HistoryManager` размещает `history.log` рядом с конфигурацией приложения (`.../fast_calc/history.log`). При необходимости можно указать иной путь:
   - относительный путь с именем файла (`"fast_calc/history.txt"`);
   - абсолютный путь.
2. В начале работы вызовите `load()`, чтобы считать уже существующую историю.
3. После каждой новой команды добавляйте запись через `add_entry`.
4. Периодически или при завершении сессии вызывайте `save()`, чтобы сбросить буфер на диск.

### Пример использования
```cpp
HistoryManager history; // ~/.config/fast_calc/history.log на Linux
history.load();

history.add_entry("2 + 2 = 4");
history.add_entry("sqrt(16) = 4");

for (const auto& line : history.get_history()) {
    std::cout << line << '\n';
}

history.save();
```
> Если аргумент не задан, `HistoryManager` использует `history.log` в директории `fast_calc` внутри системного каталога конфигурации. При передаче значения без имени файла за вас будет добавлено расширение `.log`.
